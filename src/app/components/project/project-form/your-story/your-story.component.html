<div class="region region-content col-sm-8" [formGroup]="YourStoryForm">
  <div class="your-story">
    <div class="form-group required projectName">
      <label for="projectName">Project Name</label>
      <input [ngClass]="{valError: !YourStoryForm.controls.title.valid && TryToSubmitPrivatePublic}" type="text" class="form-control" id="projectName" formControlName="title" placeholder="{{TooltipText.project_name.guide}}" validate-onfocusout maxlength="50">
      <!--<div *ngIf="formErrors.title && YourStoryForm.controls.title.touched" class="alert alert-danger error-msg">
        {{ formErrors.title }}
      </div>-->
    </div>
    <div class="form-group required">
      <label for="teaser">Teaser</label>
      <textarea [ngClass]="{valError:  !YourStoryForm.controls.field_teaser.valid&&TryToSubmitPrivatePublic}" maxlength="250" class="form-control" rows="5" id="teaser" formControlName='field_teaser' placeholder="{{TooltipText.teaser.guide}}"></textarea>
    </div>
    <span class="words-count">{{YourStoryForm.value.field_teaser.length}}\250</span>
    <!--<div *ngIf="formErrors.field_teaser" class="alert alert-danger error-msg">
      {{ formErrors.field_teaser }}
    </div>-->
    <div class="form-group required cover d-flex flex-column">
      <label class="control-label">Cover photo</label><br>
      <div class="align-items-start">
        <a [ngClass]="{valError: !cover_image.file && TryToSubmitPrivatePublic}" (click)="OpenCoverImageModal(coverimagemodal)" id="cover-upload-link" class="btn btn-white btn-sharp">Choose</a>
        <!--<input id="cover-upload" type="file" class="file" placeholder="Cover" (change)="ImageUpdated($event)" >-->
        <div class="image-preview">
          <p *ngIf="!YourStoryForm.value.field_cover_photo.file">choose a photo that is at least 600 x 400 px</p>
          <img *ngIf="YourStoryForm.value.field_cover_photo.file" [src]="YourStoryForm.value.field_cover_photo.file" class="img-responsive">
        </div>
      </div>
      <!--<div *ngIf="formErrors.field_cover_photo" class="alert alert-danger error-msg">
        {{ formErrors.field_cover_photo }}
      </div>-->
    </div>
    <div class="form-group required projectCategory d-flex flex-column">
      <label for="projectCategory" class="">Topics</label>
      <div class="categories-group d-flex flex-row row">
        <div class="col-md-4">
          <select #parentcategory [ngClass]="{valError: !YourStoryForm.controls.field_categories.valid&&TryToSubmitPrivatePublic}" class="form-control" type="text" class="form-control" id="projectCategoryParent" (change)="SelectTerm($event.target.value,'parent')">
            <option disabled selected value="_none_" > Select Category </option>
            <option *ngFor="let parent_category of project_categories_parents; let i=index" value="{{parent_category.tid}}" [innerHTML]="parent_category.name"></option>
          </select>
          <span>Choose as many topics as your project relates to.</span>
        </div>
        <div class="col-md-4">
          <select [ngClass]="{valError: !YourStoryForm.controls.field_categories.valid&&TryToSubmitPrivatePublic}" *ngIf="current_parent_category" class="form-control" type="text" class="form-control" id="projectCategoryChildren"
            (change)="SelectTerm($event.target.value,'child')">
            <option disabled selected value > Select Topic </option>
            <option *ngFor="let child_category of child_categories; let i=index" value="{{child_category.tid}}" [innerHTML]="child_category.name"></option>
            </select>
        </div>
        <br>
        <div *ngIf="current_child_category" (click)="SetCategories(parentcategory)" class="btn btn-main add-cate col-md-2">add</div>
      </div>
    </div>
    <div class="d-flex flex-column cate-list row">
      <!--<div *ngIf="formErrors.field_categories" class="alert alert-danger error-msg col-md-12">
        {{ formErrors.field_categories }}
      </div>-->
      <span>Selected topics</span>
      <div *ngIf="project.field_categories.und" class="cate-list">
        <div *ngFor="let selected_cate of project.field_categories.und; let i=index">
          <div *ngFor="let cate of all_categories" class="">
            <p *ngIf="cate.parent_tid && selected_cate == cate.tid" class="cate-name list-group-item">
              <span [innerHTML]="cate.parentName"></span> : <span [innerHTML]="cate.name"></span>
              <i class="remove-cate ml-auto fa fa-lg fa-times" (click)="RemoveCategory(cate.tid,cate.parent_tid)" aria-hidden="true"></i>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="form-group required project-story">
      <label for="project-story">The Story</label>
      <ckeditor #ckeditor [ngClass]="{valError: !YourStoryForm.controls.field_story.valid&&TryToSubmitPrivatePublic}" rows="5" id="project-story" [config]="CKEditorConfig" formControlName='field_story'></ckeditor>
      <!--<div *ngIf="formErrors.field_story" class="alert alert-danger error-msg">
        {{ formErrors.field_story }}
      </div>-->
    </div>
    <div class="form-group show-tell">
      <label for="show-tell">{{TooltipText.show_tell.guide}}</label>
      <input [ngClass]="{valError: formErrors.field_show_tell_video}" type="text" class="form-control" id="show-tell" placeholder="Add a YoutTube or Vimeo URL" formControlName='field_show_tell_video'>
      <!--<div *ngIf="formErrors.field_show_tell_video" class="alert alert-danger error-msg">
        {{ formErrors.field_show_tell_video }}
      </div>-->
    </div>
    <div class="form-group show-tell-as-default" *ngIf="!formErrors.field_show_tell_video && YourStoryForm.controls.field_show_tell_video.value">
      <div class="checkbox">
        <input id="show-tell-as-default" type="checkbox" formControlName="field_show_tell_video_as_default" (change)="$event.target.checked? (YourStoryForm.controls.field_show_tell_video_as_default.patchValue(1)) : (YourStoryForm.controls.field_show_tell_video_as_default.patchValue(0))"><label for="show-tell-as-default">Show & Tell video as default</label>
      </div>
    </div>
    <div class="form-group aha">
      <label for="aha">{{TooltipText.aha_moment.guide}}</label>
      <textarea [ngClass]="{valError: formErrors.field_aha_moment}" maxlength="350" type="text" class="form-control" id="aha" placeholder="What was your biggest insight during the buid?" formControlName='field_aha_moment'></textarea>
      <span class="words-count">{{YourStoryForm.value.field_aha_moment.length}}\350</span>
      <!--<div *ngIf="formErrors.field_aha_moment" class="alert alert-danger error-msg">
        {{ formErrors.field_aha_moment }}
      </div>-->
    </div>

    <div class="form-group uh-oh">
      <label for="uh-oh">{{TooltipText.uh_oh_moment.guide}}</label>
      <textarea [ngClass]="{valError: formErrors.field_uh_oh_moment}" maxlength="350" type="text" class="form-control" id="uh-h" placeholder="What was your biggest surprise or stress during the build?" formControlName='field_uh_oh_moment'></textarea>
      <span class="words-count">{{YourStoryForm.value.field_uh_oh_moment.length}}\350</span>

      <!--<div *ngIf="formErrors.field_uh_oh_moment" class="alert alert-danger error-msg">
        {{ formErrors.field_uh_oh_moment }}
      </div>-->
    </div>

    <!--<div class="form-group projectTags">
      <label for="projectTags">Tags</label>
      <tag-input type="text" class="form-control" id="projectTags" formControlName='field_tags' [modelAsStrings]="true"
        [(ngModel)]="tags" placeholder="{{TooltipText.tags.guide}}"></tag-input>
    </div>-->
  </div>
  <!-- End your-story -->
</div>
<!--side bar help text-->
<aside class="col-md-4">
  <div class="your-story-guide">
    <h2>Helpful Hints</h2>
    <br>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.projectName.title}}</h4>
        <p>{{sidebarText.projectName.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.teaser.title}}</h4>
        <p>{{sidebarText.teaser.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.cover_image.title}}</h4>
        <p>{{sidebarText.cover_image.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.category.title}}</h4>
        <p>{{sidebarText.category.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.story.title}}</h4>
        <p>{{sidebarText.story.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.show_tell.title}}</h4>
        <video width="250" height="150" controls>
          <source src="/assets/videos/show_tell_video.mp4" type="video/mp4">
        </video>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.aha.title}}</h4>
        <p>{{sidebarText.aha.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.uh.title}}</h4>
        <p>{{sidebarText.uh.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left question-mark"><i class="fa fa-2x fa-question-circle"></i></div>
      <div class="pull-left content">
        <h4>{{sidebarText.tags.title}}</h4>
        <p>{{sidebarText.tags.guide}}</p>
      </div>
    </div>
  </div>
</aside>


<!--Cover image modal-->
<template #coverimagemodal let-c="close" let-d="dismiss" ngbModalContainer>
  <div class="modal-header">
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
		<ul class="list-unstyled">
			<li class="upload" (click)="PhotoModalTab = 'upload'"><a class="btn btn-transparent" [ngClass]="{'active':PhotoModalTab == 'upload'}">Upload</a></li>
			<li class="your-photos" (click)="PhotoModalTab = 'filemanager'"><a class="btn btn-transparent" [ngClass]="{'active':PhotoModalTab == 'filemanager'}">Your Photos</a></li>
		</ul>
		<span class="info uplad">
      <p>DID YOU KNOW?</p>
      <p>You can also add images from your phone and they will be available here under "Your Photos"</p>
		</span>
  </div>
  <div class="modal-body">
    <div [hidden]="PhotoModalTab != 'upload'" ng2FileDrop class="upload-tab pull-left" (ng2FileDropFileAccepted)="dragFileAccepted($event,imagecropper)">
			<!--<img *ngIf="!imagedata.original" src="./assets/images/Drag_Drop.png" alt="">-->
			<img-cropper #imagecropper [image]="imagedata" [settings]="cropperSettings"></img-cropper><br>
			<div>
				<p>Drag a photo here</p>
				<p>or</p>
			</div>
			<a class="btn btn-white" (click)="file.click()">
				Select a photo from your computer
				<input id="custom-upload" class="hidden-xs-up" type="file" #file (change)="UploadBtn($event.target.files[0],imagecropper)">
			</a>
		</div>
		<app-file-browser *ngIf="PhotoModalTab == 'filemanager'" (emitter)="SelectFileAndSave(closebtn,$event)"></app-file-browser>
  </div>
  <div class="modal-footer">
    <button #closebtn type="button" class="btn btn-secondary" (click)="c('Close click')">Close</button>
    <button *ngIf="PhotoModalTab == 'upload'" type="button" class="btn btn-primary" (click)="ImageUpdated(closebtn)">Save</button>
  </div>
</template>
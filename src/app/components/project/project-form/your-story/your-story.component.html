<div class="region region-content col-md-8" [formGroup]="YourStoryForm">
  <div class="your-story">
    <p class="red-text">* Fileds required to publish</p>
    <div class="form-group required projectName">
      <label for="projectName" [ngClass]="{valErrorString: !YourStoryForm.controls.title.valid && TryToSubmitPrivatePublic}">Project Name</label>
      <input [ngClass]="{valError: !YourStoryForm.controls.title.valid && TryToSubmitPrivatePublic}" type="text" class="form-control"
        id="projectName" formControlName="title" placeholder="{{TooltipText.project_name.guide}}" validate-onfocusout maxlength="50">
      <!--<div *ngIf="formErrors.title && YourStoryForm.controls.title.touched" class="alert alert-danger error-msg">
        {{ formErrors.title }}
      </div>-->
    </div>
    <div class="form-group required">
      <label for="teaser" [ngClass]="{valErrorString:  !YourStoryForm.controls.field_teaser.valid&&TryToSubmitPrivatePublic}">Teaser</label>
      <textarea [ngClass]="{valError:  !YourStoryForm.controls.field_teaser.valid&&TryToSubmitPrivatePublic}" maxlength="250" class="form-control"
        rows="5" id="teaser" formControlName='field_teaser' placeholder="{{TooltipText.teaser.guide}}"></textarea>
      <span class="words-count">{{YourStoryForm.value.field_teaser.length}}\250 chars</span>
    </div>

    <!--<div *ngIf="formErrors.field_teaser" class="alert alert-danger error-msg">
      {{ formErrors.field_teaser }}
    </div>-->
    <div class="form-group required cover d-flex flex-column">
      <div class="d-flex align-items-center">
        <label class="control-label" [ngClass]="{valErrorString: !cover_image.file && TryToSubmitPrivatePublic}">Cover photo </label>
        <p class="small-text">Choose a photo that is at least 600 x 400 px</p>
      </div>
      <div class="align-items-start">
        <a [ngClass]="{valError: !cover_image.file && TryToSubmitPrivatePublic}" (click)="OpenCoverImageModal(coverimagemodal)" id="cover-upload-link"
          class="btn btn-load-more">CHOOSE FILE</a>
        <div class="image-preview">

          <img *ngIf="YourStoryForm.value.field_cover_photo.file" [src]="YourStoryForm.value.field_cover_photo.file" class="img-responsive">
        </div>
      </div>
      <!--<div *ngIf="formErrors.field_cover_photo" class="alert alert-danger error-msg">
        {{ formErrors.field_cover_photo }}
      </div>-->
    </div>
    <div class="form-group required projectCategory d-flex flex-column">
      <div class="d-flex align-items-center">
        <label for="projectCategory" class="" [ngClass]="{valErrorString: !YourStoryForm.controls.field_categories.valid&&TryToSubmitPrivatePublic}">Topics</label>
        <p class="small-text">Choose as many topics as your project relates to.</p>
      </div>

      <div class="categories-group d-flex flex-row row">
        <div class="col-md-4">
          <i class="dropdownIcon lnr lnr-chevron-down"></i>
          <select #parentcategory [ngClass]="{valError: !YourStoryForm.controls.field_categories.valid&&TryToSubmitPrivatePublic}"
            class="form-control" type="text" class="shadowed form-control" id="projectCategoryParent" (change)="SelectTerm($event.target.value,'parent')">
            <option disabled selected value="_none_"> Select Topics </option>
            <option *ngFor="let parent_category of project_categories_parents; let i=index" value="{{parent_category.tid}}" [innerHTML]="parent_category.name"></option>
          </select>
        </div>
        <div class="col-md-4">
          <i class="dropdownIcon lnr lnr-chevron-down" *ngIf="current_parent_category"></i>
          <select [ngClass]="{valError: !YourStoryForm.controls.field_categories.valid&&TryToSubmitPrivatePublic}" *ngIf="current_parent_category"
            class="form-control" type="text" class="shadowed form-control" id="projectCategoryChildren" (change)="SelectTerm($event.target.value,'child');SetCategories(parentcategory)">
            <option disabled selected value> Select Topic </option>
            <option *ngFor="let child_category of child_categories; let i=index" value="{{child_category.tid}}" [innerHTML]="child_category.name"></option>
            </select>
        </div>
        <br>
        <!--<div *ngIf="current_child_category" (click)="SetCategories(parentcategory)" class="btn btn-main add-cate col-md-2">add</div>-->
      </div>
    </div>
    <div class="d-flex flex-column cate-list row">
      <!--<div *ngIf="formErrors.field_categories" class="alert alert-danger error-msg col-md-12">
        {{ formErrors.field_categories }}
      </div>-->
      <div *ngIf="project.field_categories.und" class="cate-list">
        <div *ngFor="let selected_cate of project.field_categories.und; let i=index">
          <label for="" class="selected-topic" *ngIf="i == 1">Selected Topic</label>
          <div *ngFor="let cate of all_categories" class="">
            <p *ngIf="cate.parent_tid && selected_cate == cate.tid" class="cate-name list-group-item">
              <span [innerHTML]="cate.parentName"></span> &nbsp; &nbsp; &nbsp; : &nbsp; &nbsp; &nbsp; <span [innerHTML]="cate.name"></span>
              <i class="remove-cate ml-auto lnr lnr-cross" (click)="RemoveCategory(cate.tid,cate.parent_tid)" aria-hidden="true"></i>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="form-group required project-story">
      <label for="project-story" [ngClass]="{valErrorString: !YourStoryForm.controls.field_story.valid&&TryToSubmitPrivatePublic}">The Story</label>
      <ckeditor #ckeditor [ngClass]="{valError: !YourStoryForm.controls.field_story.valid&&TryToSubmitPrivatePublic}" rows="5"
        id="project-story" [config]="CKEditorConfig" formControlName='field_story'></ckeditor>
      <!--<div *ngIf="formErrors.field_story" class="alert alert-danger error-msg">
        {{ formErrors.field_story }}
      </div>-->
    </div>
    <div class="form-group show-tell">
      <label for="show-tell">Add Video: Show &amp; Tell</label>
      <input [ngClass]="{valError: formErrors.field_show_tell_video}" type="text" class="form-control" id="show-tell" placeholder="Add a YouTube or Vimeo URL"
        formControlName='field_show_tell_video' add-protocol>
      <div *ngIf="formErrors.field_show_tell_video" class="alert alert-danger error-msg">
        {{ formErrors.field_show_tell_video }}
      </div>
    </div>
    <div class="form-group show-tell-as-default" *ngIf="!formErrors.field_show_tell_video && YourStoryForm.controls.field_show_tell_video.value">
      <label class="custom-control custom-checkbox" for="show-tell-as-default">
        <input type="checkbox" class="custom-control-input" id="show-tell-as-default" formControlName="field_show_tell_video_as_default" (change)="$event.target.checked? (YourStoryForm.controls.field_show_tell_video_as_default.patchValue(1)) : (YourStoryForm.controls.field_show_tell_video_as_default.patchValue(0))">
        <span class="custom-control-indicator"></span>
        <span class="custom-control-description">Show & Tell video as default</span>
      </label>
    </div>
    <div class="form-group aha">
      <label for="aha">AHA! Moment</label>
      <textarea rows="5" [ngClass]="{valError: formErrors.field_aha_moment}" maxlength="350" type="text" class="form-control" id="aha"
        placeholder="What was your biggest insight during the build?" formControlName='field_aha_moment'></textarea>
      <span class="words-count">{{YourStoryForm.value.field_aha_moment.length}}\350 chars</span>
    </div>

    <div class="form-group uh-oh">
      <label for="uh-oh">Uh-Oh! Moment</label>
      <textarea rows="5" [ngClass]="{valError: formErrors.field_uh_oh_moment}" maxlength="350" type="text" class="form-control"
        id="uh-h" placeholder="What was your biggest surprise or stress during the build?" formControlName='field_uh_oh_moment'></textarea>
      <span class="words-count">{{YourStoryForm.value.field_uh_oh_moment.length}}\
        350 chars</span>
    </div>
  </div>
  <!-- End your-story -->
</div>
<!--side bar help text-->
<aside class="col-md-4">
  <div class="your-story-guide hidden-sm-down">
    <h2 class="col-12">Helpful Hints</h2>
    <br>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.projectName.title}}</h5>
        <p>{{sidebarText.projectName.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.teaser.title}}</h5>
        <p>{{sidebarText.teaser.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.cover_image.title}}</h5>
        <p>{{sidebarText.cover_image.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.category.title}}</h5>
        <p>{{sidebarText.category.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.story.title}}</h5>
        <p>{{sidebarText.story.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.show_tell.title}}</h5>
        <!--<video width="250" height="150" controls>
          <source src="/assets/videos/show_tell_video.mp4" type="video/mp4">
        </video>-->
        <div class="embed-responsive">
          <video-viewer [link]="showAndTellLink"></video-viewer>
        </div>
        <span class="pt-2">--links coming soon-</span>
      </div>
    </div>
    <!--<div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.aha.title}}</h5>
        <p>{{sidebarText.aha.guide}}</p>
      </div>
    </div>
    <div class="guideline">
      <div class="pull-left content">
        <h5>{{sidebarText.uh.title}}</h5>
        <p>{{sidebarText.uh.guide}}</p>
      </div>
  </div>-->
      
    </div>
</aside>

<!--Cover image modal-->
<template #coverimagemodal let-c="close" let-d="dismiss">
  <div class="upload-cover-modal">



    <div class="modal-header">
      <button type="button" class="close ml-auto" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
      </button>
    </div>

    <div class="modal-tabs">
      <ul class="list-unstyled">
        <li class="upload" (click)="PhotoModalTab = 'upload'"><a class="btn btn-transparent" [ngClass]="{'active':PhotoModalTab == 'upload'}">UPLOAD</a></li>
        <li class="your-photos" (click)="PhotoModalTab = 'filemanager'"><a class="btn btn-transparent" [ngClass]="{'active':PhotoModalTab == 'filemanager'}">YOUR PHOTOS</a></li>
      </ul>
    </div>

    <!--
      <span class="info uplad">
      <p>DID YOU KNOW?</p>
      <p>You can also add images from your phone and they will be available here under "Your Photos"</p>
		</span>-->

    <div class="modal-body">
      <div id="portfolio-photo" class="w-100 container">
        <div [hidden]="PhotoModalTab != 'upload'" ng2FileDrop class="upload-tab row" (ng2FileDropFileAccepted)="dragFileAccepted($event,imagecropper)">
          <div class="drop-section col-md-7">
            <img *ngIf="!imagedata.original" class="image-background" src="./assets/images/icons/Photos Icon.png" alt="">
            <img-cropper [hidden]="!imagedata.original" #imagecropper [image]="imagedata" [settings]="cropperSettings"></img-cropper><br>
            <div>
              <p>Drag a photo here</p>
              <p>or</p>
            </div>
            <a class="btn btn-load-more" (click)="file.click()">
				      Upload
				      <input id="custom-upload" class="hidden-xs-up" type="file" #file (change)="UploadBtn($event.target.files[0],imagecropper)">
			      </a>
          </div>
          <div class="recommended-section col-md-4">
            <p class="drag-text mt-4 mb-0">Recommended minimum resolution 600 by 600 pixels</p>
          </div>
        </div>
        <app-file-browser *ngIf="PhotoModalTab == 'filemanager'" (emitter)="SelectFileAndSave(closebtn,$event)"></app-file-browser>
      </div>
    </div>



    <div class="modal-footer">
      <button #closebtn type="button" class="btn btn-load-more" (click)="c('Close click')">Close</button>
      <button *ngIf="PhotoModalTab == 'upload'" type="button" class="btn btn-load-more" (click)="ImageUpdated(closebtn)">Save</button>
    </div>
  </div>
</template>
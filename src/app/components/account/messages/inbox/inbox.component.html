<div class="page-inbox">
    <header class="inbox-header container">
      <ul class="list-unstyled">
        <li><a href="/inbox" class="btn btn-grey  active">Messages</a></li>
        <li><a href="" class="btn btn-grey ">Notificatoins</a></li>
      </ul>
      <span class="fa fa-lg fa-cog"></span>
    </header><!--/header -->             
    <div class="container messages">
      <section class="inbox-controls"> 
        <div class="selectall">
          <input type="checkbox" name="all" [checked]="isAllChecked()" (change)="checkAll($event)"> Select all
        </div>
        <a  class="btn btn-transparent delete" (click)=" deleteMessages()">Delete</a>
        <a class="btn btn-blue btn-sharp new-message" data-dismiss="modal" data-target="#message-modal" data-toggle="modal"><i class="fa fa-lg fa-plus" ></i>New Message</a>
      </section>
      <ul class="list-unstyled messages-list">
          <div *ngIf="msg"> 
            <div *ngIf="sender"> 
              <li class="message-item" *ngFor="let message of msg">
                <div class="select"> 
                  <input type="checkbox" value="{{message.thread_id}}" [(ngModel)]="message.state" (change)="valueChanged(message.thread_id,$event)" >
                </div>
                <div class="wrapper" >
                  <div class="media message-info">
                    <div class="media-left">
                      <a href="#">
                        <img class="media-object" src="http://placehold.it/150x150" alt="" class="img-responsive">
                      </a>
                    </div>
                    <div class="media-body"  >
                      <p><a href="">{{sender.first_name}}</a> sent you a message</p>
                      <p class="timestamp">{{message.last_updated | date}}</p>
                    </div>
                  </div>
                  <div class="message-subject">
                        <a  (click)="viewMessage(message.thread_id)"><h4>{{message.subject}}</h4></a>
                  </div>
                  <div class="delete">
                    <a class="fa fa-2x fa-trash delete-message" (click)="deleteMessage(message.thread_id)"></a>
                  </div>
                </div>
              </li>
            </div>
            <div *ngIf="reciver"> 
              <li class="message-item" *ngFor="let message of msg">
                <div class="select"> 
                  <input type="checkbox" value="{{message.thread_id}}" [(ngModel)]="message.state" (change)="valueChanged(message.thread_id,$event)" >
                </div>
                <div class="wrapper" >
                  <div class="media message-info">
                    <div class="media-left">
                      <a href="#">
                        <img class="media-object" src="http://placehold.it/150x150" alt="" class="img-responsive">
                      </a>
                    </div>
                    <div class="media-body"  >
                      <p>you sent a message to<a href="">{{reciver.first_name}}</a></p>
                      <p class="timestamp">{{message.last_updated | date}}</p>
                    </div>
                  </div>
                  <div class="message-subject">
                        <a (click)="viewMessage(message.thread_id)"><h4>{{message.subject}}</h4></a>
                  </div>
                  <div class="delete">
                    <a class="fa fa-2x fa-trash delete-message" (click)="deleteMessage(message.thread_id)"></a>
                  </div>
                </div>
              </li>
            </div>
        </div>
      </ul>
      <div class="load-more">
        <a class="btn btn-white" (click)="loadMore()">Load more</a>
      </div>
    </div> 
</div>
        <div class="modal-message">
          <!-- Trigger the modal with a button -->
          <!-- Modal -->
          <div id="message-modal" class="modal fade" role="dialog">
            <div class="modal-dialog">
              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body">
                  <form [formGroup]="messageForm" *ngIf="active" (ngSubmit)="onSubmit($event)" id="createMsg" class="form-horizontal">
                    <div *ngIf="SelectedUser[i]">
                      <h5>To</h5>
                      <div class=" profile-container"><!-- start profile card-->
                        <div class="profile-card">
                          <div class="left col-sm-4">
                            <div class="profile-pic">
                              <img *ngIf="SelectedUser[i].photo" src="{{SelectedUser[i].photo}}" alt="" class="img-responsive">
                              <img *ngIf="!SelectedUser[i].photo" src="http://placehold.it/100x100" alt="" class="img-responsive">
                            </div>
                          </div>
                          <div class="right col-sm-8">
                            <h4 class="profile-name"><a href="#">{{SelectedUser[i].first_name}} {{SelectedUser[i].last_name}}</a></h4>
                          </div>
                        </div><!-- End profile card -->
                      </div><!-- End Profile-container -->
                   </div>
                    <div class="form-group">
                      <label class="control-label"  >To:</label>
                        <input type="text" class="form-control" name="recipients"   formControlName="recipients" (keyup)="RefreshUsers(i,$event.target.value)" (focus)="RefreshUsers(i,$event.target.value)" >
                        <div *ngIf="reciverUser[i]" >
                              <div *ngFor="let User of reciverUser[i]" (click)="SetMember(User.uid,i)" class="result">
                                <div class="user-image-container">
                                  <img *ngIf="User.photo" src="{{User.photo}}">
                                  <img *ngIf="!User.photo" src="http://placehold.it/140x140">
                                </div>
                                <div class="data-container">
                                  <p>{{User.first_name}} {{User.last_name}}</p>
                                  <p>{{User.nickname}}</p> 
                                </div>
                              </div>
                        </div>
                      <div *ngIf="formErrors.recipients" class="alert alert-danger">
                          {{ formErrors.recipients }}
                      </div>
                    </div>
                    
                    <div class="form-group subject">
                      <label class="control-label" >Subject</label>
                      <input type="text" class="form-control" name="subject" id="subject" formControlName="subject" >
                    </div>
                    <div *ngIf="formErrors.subject" class="alert alert-danger">
                       {{ formErrors.subject }}
                    </div>
                    <div class="form-group message-text">
                      <label class="control-label">Message</label>
                      <textarea name="body" id="body" cols="30" rows="10" formControlName="body"></textarea>
                    </div>
                    <div *ngIf="formErrors.body" class="alert alert-danger">
                       {{ formErrors.body }}
                    </div>
                    <ul class="list-unstyled actions">
                        <li><a href="" class="btn btn-transparent" data-dismiss="modal">Cancel</a></li>
                        <li><button  type="submit" class="btn btn-blue btn-sharp">Send</button></li>
                    </ul> 
                  </form>
                </div>
                         
              </div>
            </div>
            </div>
        </div>
        <!--<app-send></app-send>-->
